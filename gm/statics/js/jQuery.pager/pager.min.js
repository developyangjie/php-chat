/***
* 作者：merauy@gmail.com
* 更新日期：2013年6月1日
* 来源：http://www.goodxyx.com/jquery/plugins/pager.html
* 版本：1.0
*/
$.extend({pager:function(d){var f=!1;if(this===jQuery)return new $.pager(d);for(var e in $.pagerSettings)eval(['this["set',e.charAt(0).toUpperCase(),e.substr(1),'"]=function(v){return this.setOption("',e,'",v)}'].join(""));this.toString=function(){if(this.styleType)return this.toString2();var a=[],c=this._prepare().getRegisterKey();if(1<this.numsOption.length){a[a.length]="<SPAN>\u6bcf\u9875\u663e\u793a\u6761\u6570</SPAN>";a[a.length]='<SELECT onchange="$.pagerChange('+c+',null,this.value);">';for(var b=
0,d=this.numsOption.length;b<d;++b)a[a.length]=this.numsOption[b]==this.nums?'<OPTION value="'+this.numsOption[b]+'" selected>'+this.numsOption[b]+"</OPTION>":'<OPTION value="'+this.numsOption[b]+'">'+this.numsOption[b]+"</OPTION>";a[a.length]="</SELECT>"}else a[a.length]="<SPAN>\u6bcf\u9875\u663e\u793a"+this.nums+"\u6761</SPAN>";a[a.length]="<SPAN>";a[a.length]=this.startNum+"\uff5e"+this.endNum+"/"+this.count;a[a.length]="</SPAN>";a[a.length]=1==this.page?'<span class="current prev">\u4e0a\u4e00\u9875</span>':
'<A href="#" onclick="return $.pagerChange('+c+","+this.prevPage+')">\u4e0a\u4e00\u9875</A>';if(this.numberOfButtons){b=this.page-Math.floor(this.numberOfButtons/2);if(1>b){if(b=1,d=this.numberOfButtons,d>this.pages)d=this.pages}else this.pages<this.page+this.numberOfButtons/2?(d=this.pages,b=this.pages-this.numberOfButtons+1,1>b&&(b=1)):d=b+this.numberOfButtons-1;for(d++;b<d;++b)a[a.length]=b==this.page?'<span class="current">'+this.page+"</span>":'<a href="#" onclick="return $.pagerChange('+c+","+
b+')">'+b+"</a>"}else{a[a.length]='<SELECT onchange="$.pagerChange('+c+',this.value);">';b=1;for(d=this.pages+1;b<d;++b)a[a.length]=b==this.page?'<OPTION value="'+b+'" selected>'+b+"</OPTION>":'<OPTION value="'+b+'">'+b+"</OPTION>";a[a.length]="</SELECT>"}a[a.length]=this.page!=this.nextPage?'<A href="#" onclick="return $.pagerChange('+c+","+this.nextPage+')">\u4e0b\u4e00\u9875</A>':'<span class="current next">\u4e0b\u4e00\u9875</span>';return a.join("")};this.toString2=function(){var a=[],c=this._prepare().getRegisterKey();
if(this.count<=this.nums)return"";a[a.length]=1<this.page?['<a href="#" onclick="return $.pagerChange(',c,",",this.prevPage,')">&lt; Prev</a>'].join(""):'<span class="disabled">&lt; Prev</span>';if(10>=this.pages)for(var b=1;b<=this.pages;++b)a[a.length]=b==this.page?['<span class="current">',b,"</span>"].join(""):['<a href="#" onclick="return $.pagerChange(',c,",",b,')">',b,"</a>"].join("");else if(5>=this.page){for(b=1;7>=b;++b)a[a.length]=b==this.page?['<span class="current">',b,"</span>"].join(""):
['<a href="#" onclick="return $.pagerChange(',c,",",b,')">',b,"</a>"].join("");a[a.length]=['...<a href="#" onclick="return $.pagerChange(',c,",",this.pages-1,')">',this.pages-1,"</a>"].join("");a[a.length]=['<a href="#" onclick="return $.pagerChange(',c,",",this.pages,')">',this.pages,"</a>"].join("")}else if(this.page>=this.pages-4){a[a.length]=['<a href="#" onclick="return $.pagerChange(',c,',1)">1</a>'].join("");a[a.length]=['<a href="#" onclick="return $.pagerChange(',c,',2)">2</a>...'].join("");
for(b=this.pages-6;b<=this.pages;++b)a[a.length]=b==this.page?['<span class="current">',b,"</span>"].join(""):['<a href="#" onclick="return $.pagerChange(',c,",",b,')">',b,"</a>"].join("")}else a[a.length]=['<a href="#" onclick="return $.pagerChange(',c,',1)">1</a>'].join(""),a[a.length]=['<a href="#" onclick="return $.pagerChange(',c,',2)">2</a>...'].join(""),a[a.length]=['<a href="#" onclick="return $.pagerChange(',c,",",this.page-2,')">',this.page-2,"</a>"].join(""),a[a.length]=['<a href="#" onclick="return $.pagerChange(',
c,",",this.page-1,')">',this.page-1,"</a>"].join(""),a[a.length]=['<span class="current">',this.page,"</span>"].join(""),a[a.length]=['<a href="#" onclick="return $.pagerChange(',c,",",this.page+1,')">',this.page+1,"</a>"].join(""),a[a.length]=['<a href="# onclick="return $.pagerChange(',c,",",this.page+2,')"">',this.page+2,"</a>"].join(""),a[a.length]=['...<a href="#" onclick="return $.pagerChange(',c,",",this.pages-1,')">',this.pages-1,"</a>"].join(""),a[a.length]=['<a href="#" onclick="return $.pagerChange(',
c,",",this.pages,')">',this.pages,"</a>"].join("");a[a.length]=this.page<this.pages?['<a href="#" onclick="return $.pagerChange(',c,",",this.nextPage,')">Next &gt;</a>'].join(""):'<span class="disabled">Next &gt;</span>';return a.join("")};this._prepare=function(){var a=this.numsOption;if(1==a.length)this.nums=a[0];else if(1<a.length){if(-1==$.inArray(this.nums-0,a))this.nums=a[0]}else if(1>this.nums)this.nums=20;this.pages=Math.ceil(this.count/this.nums);if(!this.pages)this.pages=1;if(1>this.page)this.page=
1;else if(this.page>this.pages)this.page=this.pages;if(this.count){if(this.startNum=(this.page-1)*this.nums+1,this.endNum=this.page*this.nums,this.endNum>this.count)this.endNum=this.count}else this.startNum=this.endNum=0;this.prevPage=1<this.page?this.page-1:1;this.nextPage=this.page<this.pages?this.page-0+1:this.pages;if(!this.ajax.url)this.ajax.url=document.URL;return this};this.setOption=function(a,c){if("object"==typeof a)for(var b in a)this.setOption(b,a[b]);else"ajax"==a?$.extend(this.ajax,
c):"ajaxContainer"==a?this.ajaxContainer=$(c):"pageContainer"==a?(this.pageContainer==$(this.pageContainer)&&this.pageContainer.html(""),f?(this.pageContainer=$(c),this.reloadBar()):this.appendTo(c)):this[a]=c;return this};this.reloadBar=function(){this.pageContainer.html(this.toString());return this};this.reload=function(){var a=this.toString();if(this.ajaxContainer){var c=this,b=this.ajax;$.extend(b.data,{page:this.page,count:this.count,nums:this.nums});$.ajax({url:b.url,data:b.data,cache:b.cache,
type:b.type,success:function(d){null===c.ajaxContainer?"function"==typeof b.end&&b.end.call(c):(c.ajaxContainer.html(d),c.pageContainer.html(a),"function"==typeof b.end&&b.end.call(c),c=a=b=null)},error:function(d,e,f){c=a=b=null;alert(e+":"+f);throw"";}})}else this.pageContainer.html(a);return this};this.getRegisterKey=function(){for(var a in $._pagers)if($._pagers[a]==this)return a;return null};this.hide=function(){this.pageContainer.hide();return this};this.show=function(){this.pageContainer.show();
return this};this.remove=function(){var a=this.getRegisterKey();if(null!==a)try{delete $._pagers[a]}catch(c){$._pagers[a]=null}this.pageContainer.html("");for(a in this)this[a]=null};this.appendTo=function(a){if(f)throw"\u53ea\u5141\u8bb8\u5904\u7406\u4e00\u6b21";f=!0;$._pagers.push(this);return this.setOption("pageContainer",a)};var d=d||{},g;$.extend(!0,this,$.pagerSettings);if(!d.nums&&this.numsFromCookie&&(g=$.cookie(this.numsCookieName)))d.nums=g;(g=d.pageContainer)&&delete d.pageContainer;for(e in d)this.setOption(e,
d[e]);g&&this.setOption("pageContainer",g)},pagerSettings:{page:1,nums:20,pages:1,count:0,numsOption:[10,20,50,100],numsFromCookie:null,numsCookieName:"_n",numsCookieAuto:!1,numberOfButtons:5,styleType:0,ajax:{url:document.URL,type:"get",data:{},cache:!0,before:null,end:null},ajaxContainer:null,pageContainer:null,onchange:null},_pagers:[],pagerChange:function(d,f,e,g){var a=$._pagers[d];if(a&&(d=function(){if(f&&a.page!=f)a.page=f;if(e&&a.nums!=e)a.nums=e,a.numsCookieAuto&&$.cookie(a.numsCookieName,
e);if(g&&a.count!=g)a.count=g;return a},f&&a.page!=f||e&&a.nums!=e||g&&a.count))if($.isFunction(a.onchange))d().reload().onchange.apply(a);else if(a.ajaxContainer){if($.isFunction(a.ajax.start)&&!1===a.ajax.start.call(a,f))return!1;d().reload()}else d().pageContainer.html(a.toString());return!1}});
